---
title: "綜合案例Ⅰ-李宜展"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{綜合案例Ⅰ-李宜展}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
tools::vignetteEngine(package = 'knitr')
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
install.packages("devtools")
library(devtools)
install_github('davidycliao/legisTaiwan')
library(legisTaiwan)
```


## 以立委質詢（Questions Answered by the Executives）為例

找出立委在第八屆會期質詢當中，包含「中國」字眼之質詢。
```{r}
library(stringr)
question_8 <- get_parlquestions(term = 8)
Q8_data <- question_8$data
Q8_China <- Q8_data[str_detect(Q8_data[["item"]], "中國", negate = FALSE),]
```

計算某位立法委員一共提出幾次有關「中國」字眼之質詢
```{r}
cat("李應元", sum(stringr::str_count(Q8_China$item, pattern = "本院李委員應元")), "\n")
cat("丁守中", sum(stringr::str_count(Q8_China$item, pattern = "本院丁委員守中")), "\n")
cat("陳其邁", sum(stringr::str_count(Q8_China$item, pattern = "本院陳委員其邁")), "\n")
```

李應元立員提出幾次有提到中國字眼之質詢
```{r}
Q8_China_li <- Q8_China[str_detect(Q8_China[["item"]], "本院李委員應元", negate = FALSE),]
Q8_China_li[c("item")]
```

丁守中立員提出幾次有提到中國字眼之質詢
```{r}
Q8_China_Ding <- Q8_China[str_detect(Q8_China[["item"]], "本院丁委員守中", negate = FALSE),]
Q8_China_Ding[c("item")]
```

## 以歷屆委員資料（Legislator Demographics）為例

```{r}
info <- get_legislators()
legislators <- info$data
```

使用`tidyverse`協助做資料整理，計算「性別」之個數。
```{r}
library(tidyverse)
legislators %>% 
  count(sex) 
```
計算「黨籍」之個數
```{r}
legislators %>% 
  count(party) 
```

製作直方圖

```{r}
library(ggplot2)

party <- legislators %>% 
  count(party) 


ggplot(data = legislators, aes(x = party)) +
  geom_bar() +
  theme(text = element_text(family = "Heiti TC Light"))
```

製作圓餅圖
```{r}
party_1 <- table(legislators$party)
party.freq <- data.frame(party_1)
names(party.freq)[1] <- "party"

ggplot(data = party.freq, aes(x = "", y = Freq, fill = party)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y", start = 0) +
  theme_void()+
  theme(text = element_text(family = "Heiti TC Light"))

```

查看不同性別於不同政黨中之比例
```{r}
ggplot(data = legislators, aes(x = party, fill = sex)) +
  geom_bar(position = "stack") +
  theme(text = element_text(family = "Heiti TC Light")) +
  coord_flip()
```

法律提案（the Records of the Bills）為例，抓取*周春米*在「民國106年1月20」至「民111年3月10日」所提之法案。
```{r}
get_bills(start_date = 1060120, end_date = 1110310, proposer = "周春米", verbose = FALSE)
```
抓取*莊瑞雄*在「民國106年1月20」至「民111年3月10日」所提之法案。
```{r}
get_bills(start_date = 1060120, end_date = 1110310, proposer = "莊瑞雄", verbose = FALSE)
```

看看「民國106年1月20日」與「民國107年3月10日」之間，有提到「原住民」的法案
```{r}
bills_data <- get_bills(start_date = 1060120, end_date = 1070310, verbose = FALSE)
bills <- bills_data$data
bills[str_detect(bills$billName, "原住民", negate = FALSE), ]
```

